<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blitz Buffet - All You Can Eat Game</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: monospace;
      touch-action: manipulation; /* Prevent zoom on double tap */
      -webkit-user-select: none; /* Prevent text selection on iOS */
      user-select: none;
    }
    button {
      touch-action: manipulation; /* Instant tap response */
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const FOODS = [
      // Good foods (positive points)
      { emoji: 'ðŸ•', name: 'Pizza', points: 10 },
      { emoji: 'ðŸ”', name: 'Burger', points: 15 },
      { emoji: 'ðŸŒ­', name: 'Hot Dog', points: 8 },
      { emoji: 'ðŸ—', name: 'Chicken', points: 12 },
      { emoji: 'ðŸ–', name: 'Meat', points: 14 },
      { emoji: 'ðŸ¥©', name: 'Steak', points: 20 },
      { emoji: 'ðŸ°', name: 'Cake', points: 18 },
      { emoji: 'ðŸ©', name: 'Donut', points: 10 },
      { emoji: 'ðŸª', name: 'Cookie', points: 8 },
      { emoji: 'ðŸ¦', name: 'Ice Cream', points: 12 },
      { emoji: 'ðŸŸ', name: 'Fries', points: 10 },
      { emoji: 'ðŸŒ®', name: 'Taco', points: 15 },
      { emoji: 'ðŸ•', name: 'Pizza Slice', points: 10 },
      { emoji: 'ðŸ¥“', name: 'Bacon', points: 16 },
      
      // Bad foods (vegetables - negative points)
      { emoji: 'ðŸ¥¦', name: 'Broccoli', points: -15 },
      { emoji: 'ðŸ¥•', name: 'Carrot', points: -10 },
      { emoji: 'ðŸ¥¬', name: 'Lettuce', points: -12 },
      { emoji: 'ðŸ¥’', name: 'Cucumber', points: -8 },
      { emoji: 'ðŸŒ½', name: 'Corn', points: -10 },
    ];

    function BuffetGame() {
      const [score, setScore] = useState(0);
      const [foodItems, setFoodItems] = useState([]);
      const [mouthOpen, setMouthOpen] = useState(false);
      const [feedback, setFeedback] = useState(null);
      const [gameStarted, setGameStarted] = useState(false);
      const [highScore, setHighScore] = useState(0);
      const [audioContext, setAudioContext] = useState(null);

      // Initialize audio context on first user interaction (iOS requirement)
      const initAudio = () => {
        if (!audioContext) {
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          // Resume context for iOS
          if (ctx.state === 'suspended') {
            ctx.resume();
          }
          setAudioContext(ctx);
          return ctx;
        }
        return audioContext;
      };

      // Generate burp sound using Web Audio API
      const playBurp = () => {
        const ctx = initAudio();
        if (!ctx) return;
        
        const oscillator = ctx.createOscillator();
        const gainNode = ctx.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(ctx.destination);
        
        // Random burp characteristics
        const burpType = Math.floor(Math.random() * 3);
        
        if (burpType === 0) {
          // Short burp
          oscillator.frequency.setValueAtTime(80, ctx.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(40, ctx.currentTime + 0.15);
          gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.15);
          oscillator.start(ctx.currentTime);
          oscillator.stop(ctx.currentTime + 0.15);
        } else if (burpType === 1) {
          // Medium burp with vibrato
          oscillator.frequency.setValueAtTime(100, ctx.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(45, ctx.currentTime + 0.3);
          gainNode.gain.setValueAtTime(0.35, ctx.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
          oscillator.start(ctx.currentTime);
          oscillator.stop(ctx.currentTime + 0.3);
        } else {
          // Long, deep burp
          oscillator.frequency.setValueAtTime(120, ctx.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(35, ctx.currentTime + 0.5);
          gainNode.gain.setValueAtTime(0.4, ctx.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
          oscillator.start(ctx.currentTime);
          oscillator.stop(ctx.currentTime + 0.5);
        }
        
        oscillator.type = 'sawtooth';
      };

      // Generate "yuck" sound for vegetables
      const playYuck = () => {
        const ctx = initAudio();
        if (!ctx) return;
        
        const oscillator = ctx.createOscillator();
        const gainNode = ctx.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(ctx.destination);
        
        // Descending "yuck" sound
        oscillator.frequency.setValueAtTime(800, ctx.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(200, ctx.currentTime + 0.3);
        
        gainNode.gain.setValueAtTime(0.3, ctx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
        
        oscillator.type = 'square';
        oscillator.start(ctx.currentTime);
        oscillator.stop(ctx.currentTime + 0.3);
      };

      useEffect(() => {
        if (!gameStarted) return;

        const interval = setInterval(() => {
          // Add new food item
          const randomFood = FOODS[Math.floor(Math.random() * FOODS.length)];
          const newFood = {
            ...randomFood,
            id: Date.now() + Math.random(),
            x: Math.random() * 80 + 5, // 5-85% from left
            y: -10, // Start above screen
            speed: Math.random() * 2 + 2, // Random speed
          };
          
          setFoodItems(prev => [...prev, newFood]);
        }, 1500);

        return () => clearInterval(interval);
      }, [gameStarted]);

      useEffect(() => {
        if (!gameStarted) return;

        const moveInterval = setInterval(() => {
          setFoodItems(prev => 
            prev
              .map(food => ({ ...food, y: food.y + food.speed }))
              .filter(food => food.y < 110) // Remove off-screen items
          );
        }, 50);

        return () => clearInterval(moveInterval);
      }, [gameStarted]);

      const eatFood = (food) => {
        setMouthOpen(true);
        setScore(prev => {
          const newScore = prev + food.points;
          if (newScore > highScore) setHighScore(newScore);
          return newScore;
        });
        
        // Play yuck sound for vegetables (negative points)
        if (food.points < 0) {
          playYuck();
        } else {
          // Random burp for good food (40% chance)
          if (Math.random() < 0.4) {
            setTimeout(() => playBurp(), 100);
          }
        }
        
        setFeedback({
          points: food.points,
          name: food.name,
          x: food.x,
          y: food.y,
        });

        setFoodItems(prev => prev.filter(f => f.id !== food.id));

        setTimeout(() => setMouthOpen(false), 200);
        setTimeout(() => setFeedback(null), 800);
      };

      const startGame = () => {
        initAudio(); // Initialize audio for iOS
        setGameStarted(true);
        setScore(0);
        setFoodItems([]);
        setFeedback(null);
      };

      const resetGame = () => {
        setGameStarted(false);
        setScore(0);
        setFoodItems([]);
        setFeedback(null);
      };

      return (
        <div className="w-full h-screen bg-gradient-to-b from-red-600 via-orange-500 to-yellow-400 overflow-hidden relative font-mono">
          {/* Retro border effect */}
          <div className="absolute inset-0 border-8 border-yellow-300 pointer-events-none" style={{
            boxShadow: 'inset 0 0 20px rgba(0,0,0,0.5)'
          }}></div>

          {!gameStarted ? (
            <div className="flex flex-col items-center justify-center h-full relative z-10">
              <div className="bg-yellow-300 border-8 border-red-700 p-8 rounded-lg shadow-2xl text-center" style={{
                boxShadow: '0 10px 0 #8B0000, 0 15px 20px rgba(0,0,0,0.5)'
              }}>
                <h1 className="text-6xl font-black text-red-700 mb-4" style={{
                  textShadow: '4px 4px 0 #000, -2px -2px 0 #fff'
                }}>
                  BLITZ BUFFET!
                </h1>
                <p className="text-2xl text-gray-800 mb-6 font-bold">
                  Feed the hungry man!<br/>
                  Avoid vegetables!
                </p>
                <button
                  onClick={startGame}
                  className="bg-red-600 hover:bg-red-700 text-white text-3xl font-black py-4 px-12 rounded-lg border-4 border-red-900 transition-transform hover:scale-105 active:scale-95"
                  style={{
                    boxShadow: '0 6px 0 #8B0000, 0 10px 15px rgba(0,0,0,0.4)'
                  }}
                >
                  START GAME
                </button>
                {highScore > 0 && (
                  <p className="text-xl text-gray-800 mt-4 font-bold">
                    High Score: {highScore}
                  </p>
                )}
              </div>
            </div>
          ) : (
            <>
              {/* Score Display */}
              <div className="absolute top-8 left-8 bg-yellow-300 border-4 border-red-700 px-6 py-3 rounded-lg z-20" style={{
                boxShadow: '0 6px 0 #8B0000'
              }}>
                <div className="text-4xl font-black text-red-700">
                  SCORE: {score}
                </div>
                <div className="text-sm font-bold text-gray-700">
                  HIGH: {highScore}
                </div>
              </div>

              {/* Reset Button */}
              <button
                onClick={resetGame}
                className="absolute top-8 right-8 bg-red-600 hover:bg-red-700 text-white text-xl font-black py-2 px-6 rounded-lg border-4 border-red-900 z-20"
                style={{
                  boxShadow: '0 4px 0 #8B0000'
                }}
              >
                RESET
              </button>

              {/* Hungry Man Character */}
              <div className="absolute bottom-8 left-1/2 transform -translate-x-1/2 z-10">
                <div className="relative">
                  {/* Bib */}
                  <div className="absolute top-16 left-1/2 transform -translate-x-1/2 w-32 h-24 bg-white rounded-b-full border-4 border-gray-800 z-0">
                    <div className="text-center text-2xl font-black text-red-600 mt-2">EAT!</div>
                  </div>
                  
                  {/* Head */}
                  <div className="relative z-10 bg-amber-200 w-40 h-40 rounded-full border-4 border-gray-800 flex items-center justify-center">
                    {/* Suicidal Tendencies Hat */}
                    {/* Bill/Visor */}
                    <div className="absolute -top-4 left-1/2 transform -translate-x-1/2 w-28 h-8 bg-black border-2 border-gray-800 rounded-t-lg" style={{
                      boxShadow: '0 4px 0 rgba(0,0,0,0.5)'
                    }}></div>
                    {/* Hat Crown */}
                    <div className="absolute -top-8 left-1/2 transform -translate-x-1/2 w-32 h-12 bg-black border-4 border-gray-800 rounded-t-full">
                      {/* Hat panels/seams */}
                      <div className="absolute inset-0 opacity-20" style={{
                        backgroundImage: 'linear-gradient(90deg, transparent 48%, rgba(255,255,255,0.3) 49%, rgba(255,255,255,0.3) 51%, transparent 52%)',
                        backgroundSize: '16px 100%'
                      }}></div>
                      {/* "SUICIDAL" text */}
                      <div className="absolute top-2 left-1/2 transform -translate-x-1/2 text-white text-xs font-black tracking-wider whitespace-nowrap">
                        SUICIDAL
                      </div>
                    </div>
                    {/* Hat sides */}
                    <div className="absolute -top-6 left-4 w-8 h-10 bg-black border-l-4 border-gray-800 rounded-l-lg"></div>
                    <div className="absolute -top-6 right-4 w-8 h-10 bg-black border-r-4 border-gray-800 rounded-r-lg"></div>
                    
                    {/* Eyes */}
                    <div className="absolute top-12 left-8 w-8 h-8 bg-white rounded-full border-2 border-gray-800">
                      <div className="absolute top-1 left-1 w-4 h-4 bg-black rounded-full"></div>
                    </div>
                    <div className="absolute top-12 right-8 w-8 h-8 bg-white rounded-full border-2 border-gray-800">
                      <div className="absolute top-1 left-1 w-4 h-4 bg-black rounded-full"></div>
                    </div>
                    
                    {/* Mouth */}
                    <div className={`absolute bottom-8 left-1/2 transform -translate-x-1/2 transition-all duration-200 ${
                      mouthOpen 
                        ? 'w-16 h-16 rounded-full bg-gray-900' 
                        : 'w-12 h-6 rounded-full bg-gray-900'
                    }`}>
                      {mouthOpen && (
                        <div className="absolute inset-2 bg-red-600 rounded-full"></div>
                      )}
                    </div>
                  </div>
                </div>
              </div>

              {/* Food Items */}
              {foodItems.map(food => (
                <button
                  key={food.id}
                  onClick={() => eatFood(food)}
                  className="absolute cursor-pointer hover:scale-110 transition-transform active:scale-90"
                  style={{
                    left: `${food.x}%`,
                    top: `${food.y}%`,
                    fontSize: '9rem',
                    filter: 'drop-shadow(0 4px 8px rgba(0,0,0,0.5))',
                  }}
                >
                  {food.emoji}
                </button>
              ))}

              {/* Feedback */}
              {feedback && (
                <div
                  className="absolute text-4xl font-black animate-bounce pointer-events-none z-30"
                  style={{
                    left: `${feedback.x}%`,
                    top: `${feedback.y}%`,
                    color: feedback.points > 0 ? '#22c55e' : '#ef4444',
                    textShadow: '2px 2px 0 #000, -1px -1px 0 #fff',
                  }}
                >
                  {feedback.points > 0 ? '+' : ''}{feedback.points}
                </div>
              )}
            </>
          )}

          {/* Retro Grid Background Pattern */}
          <div className="absolute inset-0 opacity-10 pointer-events-none" style={{
            backgroundImage: 'linear-gradient(rgba(0,0,0,0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(0,0,0,0.3) 1px, transparent 1px)',
            backgroundSize: '50px 50px'
          }}></div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<BuffetGame />);
  </script>
</body>
</html>
